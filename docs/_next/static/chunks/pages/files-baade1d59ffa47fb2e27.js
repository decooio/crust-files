(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{60728:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return we}});var r=t(52209),o=t(83789),i=t(80318),a=t(67294),s=t(1936),c=t(35766),l=t(86419),u=t(1300),d=t(28803),p=t(71416),f=t(65382),m=t(23499),g=t(60649),h=t(93162),v=t.n(h),b=t(92809),x=t(30266),y=t(809),w=t.n(y),j=t(9669),k=t.n(j),Z=t(75282);function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach((function(n){(0,b.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function S(){var e=(0,m.$)().t,n=(0,a.useMemo)((function(){return(0,Z.Dl)(e).map((function(e){var n,t;return N(N({},e),{},{text:"".concat(null!==(n=e.text)&&void 0!==n?n:""," (").concat(null!==(t=e.location)&&void 0!==t?t:"",")")})}))}),[e]),t=(0,a.useMemo)((function(){return Math.floor(Math.random()*(n.length-2))}),[]),r=(0,a.useState)(n[t]),o=r[0],i=r[1],s=(0,a.useCallback)((function(e,t){var r=t.value,o=n.find((function(e){return e.value===r}));o&&i(o)}),[n]);return(0,a.useMemo)((function(){return{endpoints:n,endpoint:o,setEndpoint:i,onChangeEndpoint:s}}),[n,o,s])}var P=t(345),O=t(73626),A=t(28258),E=t(37838),M=t(29163),z=t(65058);var F,I=t(96486),D=t.n(I),T=t(94184),H=t.n(T),R=t(85893),_="_null",U=function(e){var n=e.expand,t=e.list,r=e.group,o=e.select,i=e.onClickItem,a=e.onClickGroup,s=e.renderGroupTitle,c=void 0===s?null:s,l=r===o.group;return(0,R.jsxs)("div",{className:"group",children:[r!==_&&(c&&c({group:r,select:o,onClickGroup:a})||(0,R.jsxs)("div",{className:H()("title",{active:l}),onClick:a,children:[r," ",(0,R.jsx)("span",{className:"dropIcon cru-fo-chevron-down"})]})),n&&t.map((function(e,n){return(0,R.jsx)("div",{className:H()("item",{active:l&&e.value===o.value}),onClick:function(n){return i(n,{group:r,value:e.value})},children:e.text},"group_item_".concat(n))}))]})};var Y,G=a.memo((0,M.ZP)((function(e){var n,t=e.className,r=e.label,o=e.help,s=e.options,c=e.defaultValue,l=e.defaultGroup,u=void 0===l?_:l,p=e.renderGroupTitle,f=(0,a.useState)({value:c,group:u}),m=f[0],g=f[1],h=(0,a.useMemo)((function(){return D().find(s,(function(e){return(e.group||_)===m.group&&e.value===m.value}))}),[s,m]),v=(0,a.useState)(u),b=v[0],x=v[1],y=(0,z.O)(),w=(0,i.Z)(y,2),j=w[0],k=w[1],Z=function(e){var n=(0,a.useRef)(null);return(0,a.useEffect)((function(){var t,r=function(t){n.current&&n.current!==t.target&&!n.current.contains(t.target)&&e&&e(t)};return null===(t=document)||void 0===t||t.addEventListener("mouseup",r),function(){var e;null===(e=document)||void 0===e||e.removeEventListener("mouseup",r)}}),[n.current]),n}((function(){j&&k(!1)})),C=(0,a.useMemo)((function(){return D().groupBy(s,(function(e){return e.group||_}))}),[s]),N=D().keys(C);return(0,R.jsxs)("div",{className:t,onClick:function(){return k()},ref:Z,children:[r&&(0,R.jsxs)("div",{className:"label font-sans-semibold",children:[r,o&&(0,R.jsx)(d.Z,{position:"top center",trigger:(0,R.jsx)("span",{className:"icon cru-fo-question"}),content:o})]}),(0,R.jsx)("span",{className:H()("dropIcon","cru-fo-chevron-down")}),(0,R.jsx)("div",{className:"text font-sans-regular",children:null!==(n=null===h||void 0===h?void 0:h.text)&&void 0!==n?n:""}),j&&(0,R.jsx)("div",{className:"options",children:N.map((function(n,t){return(0,R.jsx)(U,{group:n,renderGroupTitle:p,select:m,expand:b===n||n===_,list:C[n],onClickGroup:function(e){x(b===n?_:n),e.stopPropagation()},onClickItem:function(n,t){g(t),e.onChange(n,t)}},"group_".concat(t))}))})]})}))(F||(F=(0,r.Z)(["\n  position: relative;\n  width: 100%;\n  border-radius: 0.57rem;\n  border: 1px solid var(--line-color);\n  padding: 0.8rem 1rem;\n  cursor: pointer;\n\n  .label {\n    font-size: 1rem;\n    font-weight: 600;\n    white-space: nowrap;\n    color: var(--main-color);\n    margin-bottom: 0.6rem;\n\n    .icon {\n      font-size: 1.3rem;\n      position: relative;\n      top: 0.2rem;\n      margin-left: 0.86rem;\n      cursor: pointer;\n      color: var(--secend-color);\n    }\n  }\n\n  .dropIcon {\n    float: right;\n    position: relative;\n    top: -0.9rem;\n    right: 0;\n  }\n\n  .text {\n    font-size: 1rem;\n    color: #999999;\n  }\n\n  .options {\n    width: 100%;\n    background: white;\n    position: absolute;\n    top: calc(100% + 1px);\n    left: 0;\n    z-index: 10;\n    border-radius: 4px;\n    border: 1px solid var(--line-color);\n    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);\n\n    .group {\n\n      .title {\n        cursor: pointer;\n        border-top: 1px solid var(--line-color);\n        padding: 0.8rem 1rem;\n        font-size: 1.2rem;\n        font-weight: 500;\n\n        &:hover, &.active {\n          background: var(--line-color);\n        }\n\n        .dropIcon {\n          float: right;\n          right: 0.6rem;\n          top: 0rem;\n        }\n      }\n\n      .item {\n        padding: 0.6rem 1.6rem;\n        cursor: pointer;\n\n        &:hover, &.active {\n          background: var(--line-color);\n        }\n      }\n    }\n  }\n"])))),L=t(60954),V=t(17082),B=function(){var e=(0,x.Z)(w().mark((function e(n){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),W=function(){var e=(0,x.Z)(w().mark((function e(n,t,r){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.deriveKey(r,n,{name:"AES-GCM",length:256},!1,t));case 1:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),K=function(){var e=(0,x.Z)(w().mark((function e(n,t){var r,o,i,a,s,c,l,u,d;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new Uint8Array(n),o=(new TextEncoder).encode(t),i=window.crypto.getRandomValues(new Uint8Array(16)),a=window.crypto.getRandomValues(new Uint8Array(12)),e.next=7,B(o);case 7:return s=e.sent,e.next=10,W(s,["encrypt"],{name:"PBKDF2",salt:i,iterations:25e4,hash:"SHA-256"});case 10:return c=e.sent,e.next=13,window.crypto.subtle.encrypt({name:"AES-GCM",iv:a},c,r);case 13:return l=e.sent,u=new Uint8Array(l),(d=new Uint8Array(u.byteLength+i.byteLength+a.byteLength)).set(i,0),d.set(a,i.byteLength),d.set(u,i.byteLength+a.byteLength),e.abrupt("return",d);case 22:throw e.prev=22,e.t0=e.catch(0),console.error("Error encrypting file"),console.error(e.t0),e.t0;case 27:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(n,t){return e.apply(this,arguments)}}(),J=function(){var e=(0,x.Z)(w().mark((function e(n,t){var r,o,i,a,s,c,l,u;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new Uint8Array(n),o=(new TextEncoder).encode(t),i=r.slice(0,16),a=r.slice(16,28),s=r.slice(28),e.next=8,B(o);case 8:return c=e.sent,e.next=11,W(c,["decrypt"],{name:"PBKDF2",salt:i,iterations:25e4,hash:"SHA-256"});case 11:return l=e.sent,e.next=14,window.crypto.subtle.decrypt({name:"AES-GCM",iv:a},l,s);case 14:return u=e.sent,e.abrupt("return",u);case 18:return e.prev=18,e.t0=e.catch(0),console.error("Error decrypting file"),console.error(e.t0),e.abrupt("return");case 23:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(n,t){return e.apply(this,arguments)}}();function X(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function $(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?X(Object(t),!0).forEach((function(n){(0,b.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function q(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return Q(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Q(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(s)throw i}}}}function Q(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var ee=function(){},ne=104857600;var te=a.memo((0,M.ZP)((function(e){var n=e.className,t=e.uc,r=e.file,o=e.onClose,c=void 0===o?ee:o,l=e.onSuccess,u=void 0===l?ee:l,d=e.user,p=(0,m.$)().t,f=S(),g=f.endpoint,h=f.endpoints,v=f.onChangeEndpoint,b=function(){var e=(0,m.$)().t,n=(0,a.useMemo)((function(){return(0,Z.qi)(e).sort((function(){return Math.random()>.5?-1:1})).map((function(e){var n;return N(N({},e),{},{text:"".concat(null!==(n=e.text)&&void 0!==n?n:"Pinner")})}))}),[e]),t=(0,a.useState)(n[0]),r=t[0],o=t[1],i=(0,a.useCallback)((function(e,t){var r=t.value,i=n.find((function(e){return e.value===r}));i&&o(i)}),[n]);return(0,a.useMemo)((function(){return{pinner:r,pins:n,setPinner:o,onChangePinner:i}}),[r,n,i])}(),y=b.onChangePinner,j=b.pinner,C=b.pins,M=(0,a.useState)(!1),F=M[0],I=M[1],D=(0,a.useMemo)((function(){if(r.file)return r.file.size>ne;if(r.files){var e,n=0,t=q(r.files);try{for(t.s();!(e=t.n()).done;){n+=e.value.size}}catch(o){t.e(o)}finally{t.f()}return n>ne}return!1}),[r]),T=(0,a.useState)(""),H=T[0],_=T[1],U=D?p("Do not upload files larger than 100MB!"):H,Y=(0,a.useState)({progress:0,up:!1}),B=Y[0],W=Y[1],J=(0,a.useState)(null),X=J[0],Q=J[1],te=(0,z.O)(),re=(0,i.Z)(te,2),oe=re[0],ie=re[1],ae=(0,a.useCallback)((function(){X&&X.cancel(),c()}),[X,c]),se=(0,a.useCallback)((0,x.Z)(w().mark((function e(){var n,o,i,a,c,l,f,m,h,v,b,x,y,Z,C,N,S,P,O,A,E,M,z,F,T,H,R,U,Y,G;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(""),console.log(d.sign),!D&&d.account&&d.sign){e.next=7;break}return console.log(!d.account),console.log(!d.sign),console.log("error"),e.abrupt("return");case 7:return e.prev=7,I(!0),n=(0,s.WJ)(d),o="near"===d.wallet?d.pubKey||"":d.account,e.next=13,d.sign(o,d.account);case 13:if(i=e.sent,a="elrond"===d.wallet?i:"".concat(n,"-").concat(o,":").concat(i),c="huochain"===d.wallet?"c3Vic3RyYXRlLWNUTDFRR2ZnS0VXb0dZVWtXcldOVmpTaHNpUXA4R0d0TFFMOWZRSzJ1MlpEV1oyVXg6MHgxMDUzOGE5NmY0YWU1M2YwOGQyZDA4MzIwMDM5N2M5MjNlMzMzNDc5ZWQzMzFmYTk1MjhhODI0MzZhYzFhYjdmMDNiMjYxM2MxZGRlY2MwMzkxZWIxYmYwMWM3OTQ0OWZjMjIwMzUyNDhjYjI5Y2Y3Yzk0OTIzNjQyMzc2ZGQ4MQ==":window.btoa(a),l="Basic ".concat(c),f="Bearer ".concat(c),m=k().CancelToken.source(),Q(m),W({progress:0,up:!0}),h=new FormData,!(v=!(!oe||!t.secret))){e.next=64;break}if(!r.file){e.next=38;break}return b=(new Date).getTime(),e.next=28,(0,V.vZ)(r.file);case 28:return x=e.sent,console.info("readFile::",((new Date).getTime()-b)/1e3),e.next=32,K(x,t.secret);case 32:y=e.sent,console.info("encrypted::",((new Date).getTime()-b)/1e3),Z=new Blob([y],{type:r.file.type}),h.append("file",Z,r.file.name),e.next=62;break;case 38:if(!r.files){e.next=62;break}C=q(r.files),e.prev=40,C.s();case 42:if((N=C.n()).done){e.next=54;break}return S=N.value,e.next=46,(0,V.vZ)(S);case 46:return P=e.sent,e.next=49,K(P,t.secret);case 49:O=e.sent,A=new Blob([O],{type:S.type}),h.append("file",A,S.webkitRelativePath);case 52:e.next=42;break;case 54:e.next=59;break;case 56:e.prev=56,e.t0=e.catch(40),C.e(e.t0);case 59:return e.prev=59,C.f(),e.finish(59);case 62:e.next=65;break;case 64:if(r.file)h.append("file",r.file,r.file.name);else if(r.files){E=q(r.files);try{for(E.s();!(M=E.n()).done;)z=M.value,h.append("file",z,z.webkitRelativePath)}catch(w){E.e(w)}finally{E.f()}}case 65:return F=g.value,e.next=68,k().request({cancelToken:m.token,data:h,headers:{Authorization:l},maxContentLength:ne,method:"POST",onUploadProgress:function(e){var n=e.loaded/e.total;W({progress:Math.round(99*n),up:!0})},params:{pin:!0},url:"".concat(F,"/api/v0/add")});case 68:return"string"===typeof(T=e.sent).data?(R=T.data.replaceAll("}\n{","},{"),U=JSON.parse("[".concat(R,"]")),Y=U.length-1,H=U[Y],delete U[Y],H.items=U):H=T.data,console.info("upResult:",T),Q(null),W({progress:99,up:!0}),G=j.value,e.next=76,k().request({data:{cid:H.Hash,name:H.Name},headers:{Authorization:f},method:"POST",url:"".concat(G,"/psa/pins")});case 76:W({progress:100,up:!1}),u($($({},H),{},{PinEndpoint:G,PinTime:(new Date).getTime(),UpEndpoint:F,Encrypted:v})),e.next=86;break;case 80:e.prev=80,e.t1=e.catch(7),W({progress:0,up:!1}),I(!1),console.error(e.t1),_(p("Network Error,Please try to switch a Gateway."));case 86:case"end":return e.stop()}}),e,null,[[7,80],[40,56,59,62]])}))),[D,d,r,j,g,oe,u,p]);return(0,R.jsxs)(P.Z,{closeIcon:(0,R.jsx)("span",{className:"close icon cru-fo-x"}),onClose:ae,open:!0,size:"large",className:n,children:[(0,R.jsx)(P.Z.Header,{className:"font-sans-semisold",children:p(r.dir?"Upload Folder":"Upload File")}),(0,R.jsxs)(P.Z.Content,{children:[(0,R.jsxs)(O.Z.Group,{children:[(0,R.jsx)(O.Z,{fluid:!0,children:(0,R.jsxs)(O.Z.Content,{children:[(0,R.jsx)(O.Z.Header,{content:r.dir?"Folder":"File"}),(0,R.jsx)(O.Z.Description,{content:r.dir?"".concat(r.dir," (").concat(r.files.length," files)"):"".concat(r.file.name," (").concat(r.file.size," bytes)")})]})}),(0,R.jsx)(O.Z,{fluid:!0,children:(0,R.jsx)(G,{fluid:!0,selection:!0,className:"clear-border",help:p("File streaming and wallet authentication will be processed by the chosen gateway."),disabled:F,label:p("Select a Web3 IPFS Gateway"),onChange:v,options:h,defaultGroup:g.group,defaultValue:g.value})}),(0,R.jsx)(O.Z,{fluid:!0,children:(0,R.jsx)(G,{fluid:!0,selection:!0,className:"clear-border",help:p("Your file will be pinned to IPFS for long-term storage."),disabled:0===C.length,label:p("Select a Web3 IPFS Pinner"),onChange:y,options:C,defaultValue:j.value})}),r.file&&(0,R.jsx)(O.Z,{fluid:!0,className:"encryption",children:(0,R.jsxs)(O.Z.Content,{children:[(0,R.jsx)(O.Z.Header,{content:"File Encryption"}),t.secret?(0,R.jsx)(O.Z.Description,{content:oe?"Yes":"No"}):(0,R.jsx)(O.Z.Description,{content:"Please go to the 'Setting' page and set encryption key before activating this function."}),(0,R.jsx)(A.Z,{toggle:!0,defaultChecked:oe,disabled:!t.secret,onChange:function(){return ie()}})]})})]}),U&&(0,R.jsx)("div",{style:{color:"orangered",padding:"1rem",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:U})]}),(0,R.jsx)(P.Z.Actions,{children:(0,R.jsxs)("div",{className:"uploading",children:[B.up&&(0,R.jsx)(E.Z,{value:B.progress,total:100,active:!0,color:"orange"}),B.up&&(0,R.jsx)(L.Z,{onClick:ae,children:p("Cancel")}),!B.up&&(0,R.jsx)(L.Z,{fluid:!0,onClick:se,disabled:D,children:p("Sign and Upload")})]})})]})}))(Y||(Y=(0,r.Z)(['\n  width: 51.43rem !important;\n\n  .header:nth-child(2) {\n    height: 3.93rem;\n    font-size: 1.3rem !important;\n    padding: 0 1.14rem !important;\n    font-weight: 600 !important;\n    line-height: 3.93rem !important;\n  }\n\n  .close.icon {\n    top: 0.5rem;\n    right: 0.6rem;\n    color: #666666;\n  }\n\n  .content {\n    padding: 1rem !important;\n  }\n\n  .ui.cards > .card {\n    margin: 0.5rem !important;\n\n    .content > .header {\n      font-size: 1rem;\n      font-weight: unset !important;\n      color: var(--main-color);\n      font-weight: 600;\n      font-family: OpenSans-SemiBold;\n    }\n\n    .content > .description {\n      font-size: 1rem;\n      color: #999999;\n      font-family: OpenSans-Regular;\n    }\n  }\n\n  .ui.cards > .card:first-child {\n    margin-top: 1rem !important;\n  }\n\n  .actions {\n    height: 4.8rem;\n    padding: 0.5rem 1rem 0 1rem !important;\n    border-top: unset !important;\n    background: unset !important;\n\n    .button {\n      margin-left: unset !important;\n    }\n  }\n\n  .uploading {\n    height: 4rem;\n    display: flex;\n    align-items: center;\n\n    .progress {\n      margin: 0 1rem 0 0 !important;\n      vertical-align: baseline;\n      background: unset !important;\n      border: 1px solid orange;\n      flex: 1;\n\n      .bar {\n        min-width: unset !important;\n        height: 2.5rem;\n      }\n    }\n  }\n\n  .card.encryption {\n    position: relative;\n\n    .toggle {\n      position: absolute;\n      top: calc(50% - 0.75rem);\n      right: 1rem;\n\n      input[type="radio"]:checked + label:before {\n        background-color: #2ed158 !important;\n      }\n    }\n  }\n'])))),re=t(12752),oe=t(43913);var ie=t(56755),ae=t.n(ie),se=t(20478),ce=t(66103),le=t(98278);function ue(e){return e}function de(e){e.current.isActive=!1,e.current.subscriber&&(e.current.subscriber.then((function(e){return e()})).catch(console.error),e.current.subscriber=null)}function pe(e,n,t){var r=function(){var e=(0,a.useRef)(!1);return(0,a.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e}(),s=(0,a.useRef)({isActive:!1,serialized:null,subscriber:null}),c=(0,a.useState)((t||{}).defaultValue),l=c[0],u=c[1];return(0,a.useEffect)((function(){return function(){return de(s)}}),[]),(0,a.useEffect)((function(){if(r.current&&e){var a=function(e,n){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).paramMap,r=void 0===t?ue:t;return[JSON.stringify({f:null===e||void 0===e?void 0:e.name,p:n}),0!==n.length&&n.some((function(e){return(0,ce.F)(e)||(0,le.o)(e)}))?null:r(n)]}(e,n||[],t),c=(0,i.Z)(a,2),l=c[0],d=c[1];d&&l!==s.current.serialized&&(s.current.serialized=l,function(e,n,t,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=a.transform,c=void 0===s?ue:s,l=a.withParams,u=a.withParamsTransform,d=r.filter((function(e){return!(0,le.o)(e)}));de(n),setTimeout((function(){var a;e.current&&(!t||t.meta&&null!==(a=t.meta.type)&&void 0!==a&&a.isDoubleMap&&2!==d.length?n.current.subscriber=null:(n.current.isActive=!0,n.current.subscriber=t.apply(void 0,(0,o.Z)(r).concat([function(t){e.current&&n.current.isActive&&e.current&&n.current.isActive&&i(l?[r,c(t)]:c(u?[r,t]:t))}]))))}),0)}(r,s,e,d,u,t))}}),[e,t,r,n]),l}var fe,me=t(99056);function ge(e,n){var t=n.find((function(n){return n.value===e.UpEndpoint})),r=t&&t.value||n[0].value;return"".concat(r,"/ipfs/").concat(e.Hash,"?filename=").concat(e.Name)}var he,ve=a.memo((0,M.ZP)((function(e){var n,t,r,o,i=e.file,s=e.className,c=e.uc,l=(0,se.V)(),p=(0,a.useContext)(re.I),m=p.api,g=p.alert,v=p.loading,b=S().endpoints,y=(0,a.useCallback)((0,x.Z)(w().mark((function e(){var n,t,r,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.Encrypted||0!==D().size(i.items)){e.next=28;break}if(e.prev=1,c.secret){e.next=4;break}return e.abrupt("return");case 4:return v.show(),e.next=7,k().get(ge(i,b),{responseType:"arraybuffer"});case 7:return n=e.sent,console.info("res::",n),t=(new Date).getTime(),e.next=12,J(n.data,c.secret);case 12:if(r=e.sent,console.info("decrypt:",((new Date).getTime()-t)/1e3),r){e.next=16;break}throw"error";case 16:console.info("de:",r),o=new File([r],i.Name,{type:n.headers["content-type"]}),(0,h.saveAs)(o,i.Name),v.hide(),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(1),v.hide(),g.error("Decrypt error");case 26:e.next=29;break;case 28:window.open(ge(i,b),"_blank");case 29:case"end":return e.stop()}}),e,null,[[1,22]])}))),[c,i,b]),j=(0,a.useCallback)((function(){return l(ge(i,b))}),[i,b]),Z=m&&(null===(n=m.query)||void 0===n?void 0:n.market)&&(null===(t=m.query)||void 0===t?void 0:t.market.files),C=!!Z,N=pe(Z,[i.Hash]),P=pe(null===m||void 0===m||null===(r=m.derive)||void 0===r||null===(o=r.chain)||void 0===o?void 0:o.bestNumber),O=P&&P.toNumber(),A=(0,a.useMemo)((function(){var e={status:"Loading"};if(N&&!N.isEmpty){var n=function(e){try{return JSON.parse(JSON.stringify(e))}catch(n){return{expired_at:0,reported_replica_count:0,amount:0,file_size:0,prepaid:!1}}}(N),t=n.expired_at,r=n.reported_replica_count,o=n.amount,a=n.file_size,s=n.prepaid;e.expireTime=t,e.amount=o,e.startTime=t?t-216e3:0,e.fileSize=a,e.confirmedReplicas=r,e.prepaid=s,t&&t<O&&(e.status="Expired"),r<1&&(e.status="Submitted"),t&&t>O&&r>0&&(e.status="Success")}else C&&i.PinTime-(new Date).getTime()>=72e5&&(e.status="Failed");return O||(e.status="Loading"),e}),[N,O]);return(0,R.jsxs)(u.Z.Row,{className:s,children:[(0,R.jsxs)(u.Z.Cell,{className:"fileName",children:[(0,me.l)(i.Name),i.items&&(0,R.jsx)("span",{className:"icon cru-fo-folder"}),i.Encrypted&&(0,R.jsx)(d.Z,{trigger:(0,R.jsx)("span",{className:"icon cru-fo-key"}),content:"Encrypted",position:"top center"})]}),(0,R.jsxs)(u.Z.Cell,{textAlign:"center",children:[(0,me.l)(i.Hash),(0,R.jsx)(d.Z,{position:"top center",content:"Copy File CID",trigger:(0,R.jsx)("span",{className:"cru-fo cru-fo-copy",onClick:function(){return l(i.Hash)},style:{marginLeft:"1.8rem"}})})]}),(0,R.jsx)(u.Z.Cell,{textAlign:"center",style:{textTransform:"uppercase"},children:ae()(Number(i.Size),{round:2})}),(0,R.jsxs)(u.Z.Cell,{textAlign:"center",children:["Loading"===A.status&&(0,R.jsx)(f.Z,{loading:!0,name:"spinner"}),"Submitted"===A.status&&A.status,"Expired"===A.status&&A.status,"Failed"===A.status&&A.status,"Success"===A.status&&"".concat(A.status," (").concat(A.confirmedReplicas," Replicas)")]}),(0,R.jsxs)(u.Z.Cell,{textAlign:"center",children:[(0,R.jsx)(d.Z,{position:"top center",content:"Open File",trigger:(0,R.jsx)("span",{className:"cru-fo cru-fo-external-link",style:{marginRight:"1.14rem"},onClick:y})}),(0,R.jsx)(d.Z,{position:"left center",content:"Copy Download Link",trigger:(0,R.jsx)("span",{className:"cru-fo cru-fo-copy",onClick:j})})]})]})}))(fe||(fe=(0,r.Z)(["\n  color: var(--secend-color) !important;\n\n  .cru-fo, .icon {\n    cursor: pointer;\n    font-size: 1.3rem;\n    position: relative;\n    top: 0.3rem;\n  }\n\n  .fileName {\n    .icon {\n      margin-left: 0.6rem;\n    }\n  }\n\n"]))));function be(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,n=(0,a.useState)(!0),t=n[0],r=n[1];return(0,a.useEffect)((function(){var n=setInterval((function(){r((function(e){return!e}))}),e);return function(){return clearInterval(n)}}),[e]),t}function xe(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return ye(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ye(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((function(e){throw e})),f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((function(e){s=!0,i=e})),f:function(){try{a||null==t.return||t.return()}finally{if(s)throw i}}}}function ye(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var we=a.memo((0,M.ZP)((function(e){var n=(0,s.WY)(),t=(0,m.$)().t,r=(0,a.useContext)(re.I).alert,h=(0,a.useState)(!1),b=h[0],x=h[1],y=(0,s.Yg)(),w=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,t=(0,a.useState)(1),r=t[0],o=t[1];return(0,a.useMemo)((function(){var t=D().chunk(e,n);return{totalPage:t.length,pageList:t[r-1]||[],setPage:o,page:r}}),[e,r])}(y.files,7),j=(0,a.useState)(void 0),k=j[0],Z=j[1],C=(0,a.useRef)(null),N=(0,V.MH)(),S=(0,a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];C.current&&(C.current.webkitdirectory=e,C.current.multiple=e,C.current.click())}),[C]),P=(0,a.useCallback)((function(){return S(!1)}),[S]),O=(0,a.useCallback)((function(){return S(!0)}),[S]),A=(0,a.useCallback)((function(e){var n=e.target.files;if(n)if(n.length>2e3)r.alert({title:t("Upload"),msg:t("Please do not upload more than 2000 files"),type:"error"});else if(0!==n.length){if(e.target.webkitdirectory){if(n.length>=1){for(var o=[],a=0;a<n.length;a++)o.push(n[a]);console.info(o);var s=o[0].webkitRelativePath.split("/"),c=(0,i.Z)(s,1)[0];Z({files:o,dir:c}),x(!0)}}else Z({file:n[0]}),x(!0);e.target.value=""}else r.alert({title:t("Upload"),msg:t("Please select non-empty folder"),type:"error"})}),[Z,x,r,t]),E=(0,a.useRef)(null),M=(0,a.useCallback)((function(){E.current&&E.current.click()}),[E]),z=(0,a.useCallback)((function(e){try{var n=new FileReader,i=e.target.files;if(!i)return;if(n.readAsText(i[0],"UTF-8"),!/(.json)$/i.test(e.target.value))return r.alert({msg:t("File error"),type:"error"});n.onload=function(e){var n,i=JSON.parse(null===(n=e.target)||void 0===n?void 0:n.result);if(!Array.isArray(i))return r.alert({msg:t("File content error"),type:"error"});var a,s=[],c={},l=xe(i);try{for(l.s();!(a=l.n()).done;){var u=a.value;u.Hash&&u.Name&&u.UpEndpoint&&u.PinEndpoint&&(s.push(u),c[u.Hash]=!0)}}catch(p){l.e(p)}finally{l.f()}var d=y.files.filter((function(e){return!c[e.Hash]}));y.setFiles([].concat(s,(0,o.Z)(d))),r.alert({msg:t("Import Success"),type:"success"})}}catch(e){r.alert({msg:t("File content error"),type:"error"})}}),[y,r,t]),F=(0,a.useCallback)((function(){x(!1)}),[]),I=(0,a.useCallback)((function(e){x(!1);var n=y.files.filter((function(n){return n.Hash!==e.Hash}));y.setFiles([e].concat((0,o.Z)(n)))}),[y]),T=(0,a.useCallback)((function(){var e=new Blob([JSON.stringify(y.files)],{type:"application/json; charset=utf-8"});v().saveAs(e,"files.json")}),[y]),H=be(2e3),_=be(1800);return(0,R.jsx)(g.Z,{path:"/files",children:(0,R.jsxs)(c.Z,{basic:!0,className:e.className,children:[(0,R.jsx)(oe.Z,{}),(0,R.jsxs)(c.Z,{basic:!0,className:"contentPanel",children:[(0,R.jsxs)(c.Z,{basic:!0,textAlign:"center",className:"font-sans-semibold uploadPanel",children:[(0,R.jsx)("input",{onChange:A,ref:C,style:{display:"none"},type:"file"}),(0,R.jsx)("input",{onChange:z,ref:E,style:{display:"none"},type:"file"}),(0,R.jsxs)("div",{className:"upSlog",children:["Upload and Store your File or Folder to IPFS via ",(0,R.jsx)("a",{target:"_blank",href:"https://apps.crust.network",rel:"noreferrer",children:"Crust"}),"\u2019s decentralized storage network."]}),(0,R.jsxs)("div",{className:"btns",children:[(0,R.jsx)(l.Z,{animation:"pulse",duration:500,visible:H,children:(0,R.jsxs)("span",{className:"btn file",onClick:P,children:[(0,R.jsx)("span",{className:"cru-fo cru-fo-file"})," ",(0,R.jsx)("br",{}),"File"]})}),(0,R.jsx)(l.Z,{animation:"pulse",duration:500,visible:_,children:(0,R.jsxs)("span",{className:"btn folder",onClick:O,children:[(0,R.jsx)("span",{className:"cru-fo cru-fo-folder"})," ",(0,R.jsx)("br",{}),"Folder"]})})]}),b&&(0,R.jsx)(te,{file:k,user:n,onClose:F,onSuccess:I,uc:N})]}),(0,R.jsx)("div",{className:"line"}),(0,R.jsxs)(u.Z,{basic:"very",children:[(0,R.jsx)(u.Z.Header,{className:"font-sans-semibold",children:(0,R.jsxs)(u.Z.Row,{children:[(0,R.jsx)(u.Z.HeaderCell,{children:"File Name"}),(0,R.jsx)(u.Z.HeaderCell,{textAlign:"center",children:"File CID"}),(0,R.jsx)(u.Z.HeaderCell,{textAlign:"center",children:"File Size"}),(0,R.jsx)(u.Z.HeaderCell,{textAlign:"center",children:"Status"}),(0,R.jsx)(u.Z.HeaderCell,{textAlign:"center",children:"Action"})]})}),(0,R.jsx)(u.Z.Body,{className:"font-sans-regular",children:w.pageList.map((function(e,n){return(0,R.jsx)(ve,{uc:N,file:e},"files_item_".concat(n))}))}),(0,R.jsx)(u.Z.Footer,{children:(0,R.jsxs)(u.Z.Row,{children:[(0,R.jsxs)(u.Z.HeaderCell,{colSpan:w.totalPage>1?2:5,className:"btns",children:[(0,R.jsx)(L.Z,{onClick:M,children:"Import"}),(0,R.jsx)(L.Z,{onClick:T,children:"Export"}),(0,R.jsx)(d.Z,{position:"top center",wide:"very",trigger:(0,R.jsx)("span",{className:"cru-fo-help-circle",style:{fontSize:"1.3rem"}}),content:"Crust Files is a decentralized Application, and it will NEVER store your Upload History and File Encryption Key on any remote server. Instead, they are cached on your local devices. If you want to migrate your Upload History and File Encryption Key to a new device, use Export & Import function."})]}),w.totalPage>1&&(0,R.jsx)(u.Z.HeaderCell,{colSpan:"3",textAlign:"right",children:(0,R.jsx)(p.Z,{totalPages:w.totalPage,activePage:w.page,firstItem:null,lastItem:null,prevItem:{content:(0,R.jsx)(f.Z,{name:"angle left"}),icon:!0},nextItem:{content:(0,R.jsx)(f.Z,{name:"angle right"}),icon:!0},secondary:!0,onPageChange:function(e,n){var t=n.activePage;return w.setPage(t)}})})]})})]})]})]})})}))(he||(he=(0,r.Z)(["\n  padding: unset !important;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n\n  .contentPanel {\n    max-width: 100rem;\n    width: 100%;\n    margin: unset !important;\n    padding: unset !important;\n  }\n\n  .table {\n    padding: 1rem 2rem;\n    width: 100%;\n    thead {\n      font-size: 1.29rem;\n      font-weight: 600;\n\n      th:first-child {\n        padding-left: 0.57rem !important;\n      }\n\n      th {\n        border-bottom: unset !important;\n      }\n    }\n\n    tbody {\n      color: var(--secend-color);\n\n      tr, td {\n        border-top: unset !important;\n      }\n\n      tr > td:first-child {\n        padding-left: 0.57rem !important;\n      }\n\n      tr:nth-child(2n - 1) {\n        background-color: #f8f8f8;\n\n        td:first-child {\n          overflow: hidden;\n          border-top-left-radius: 0.57rem;\n          border-bottom-left-radius: 0.57rem;\n        }\n\n        td:last-child {\n          overflow: hidden;\n          border-top-right-radius: 0.57rem;\n          border-bottom-right-radius: 0.57rem;\n        }\n      }\n    }\n\n    tfoot {\n      .btns > button {\n        margin-right: 1rem !important;\n      }\n\n      th {\n        border-top: unset !important;\n      }\n\n      .btns {\n        span {\n          cursor: pointer;\n          color: #808080;\n        }\n      }\n\n      .btns > i {\n        color: var(--secend-color);\n        cursor: pointer;\n      }\n\n      .pagination > .item {\n        color: var(--secend-color);\n        padding: 0.8rem 1rem !important;\n        min-width: unset !important;\n        border-radius: 5rem !important;\n        margin: unset;\n      }\n    }\n  }\n\n  .line {\n    margin: 0 2.3rem;\n    border-bottom: solid 1px var(--line-color) !important;\n  }\n  \n  .uploadPanel {\n    width: 100%;\n    justify-content: space-between;\n    font-size: 4rem !important;\n    font-weight: 600;\n    margin: unset !important;\n    white-space: pre-wrap;\n    padding: 2.5rem 2.3rem;\n    color: var(--main-color);\n    display: flex;\n    align-items: center;\n\n    .upSlog {\n      margin: unset !important;\n      display: inline-block;\n      cursor: default;\n      font-size: 2.8rem;\n      padding-right: 1rem;\n      max-width: 50rem;\n      min-width: 24rem;\n      white-space: pre-wrap;\n      line-height: 3.8rem;\n      text-align: left;\n      vertical-align: top;\n\n      a {\n        text-decoration: unset;\n        color: var(--primary-color);\n      }\n    }\n\n    .btns {\n      display: inline-block;\n      flex-shrink: 0;\n    }\n\n    .btn {\n      vertical-align: top;\n      line-height: 4.43rem;\n      display: inline-block;\n      width: 16rem;\n      height: 15rem;\n      font-size: 3.3rem;\n      text-align: center;\n      border-radius: 50px;\n      cursor: pointer;\n      padding: 3rem 0;\n      //transition: all ease-in-out 2s;\n      .cru-fo {\n        font-size: 4rem;\n      }\n    }\n\n    .btn:first-child {\n      margin-right: 1.6rem;\n    }\n\n    .file {\n      background: rgba(255, 141, 0, 0.1);\n      margin-right: 1rem;\n\n      &:hover {\n        background: rgba(255, 141, 0, 0.2);\n        box-shadow: 0 0.14rem 1.43rem 0 rgba(0, 0, 0, 0.1);\n      }\n    }\n\n    .folder {\n      background: rgba(86, 203, 143, 0.1);\n\n      &:hover {\n        background: rgba(86, 203, 143, 0.2);\n        box-shadow: 0 0.14rem 1.43rem 0 rgba(0, 0, 0, 0.1);\n      }\n    }\n  }\n\n"]))))},76841:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/files",function(){return t(60728)}])}},function(e){e.O(0,[411,786,914,227,603,774,888,179],(function(){return n=76841,e(e.s=n);var n}));var n=e.O();_N_E=n}]);