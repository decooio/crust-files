(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{21160:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Oe}});var r,o=t(52209),i=t(83789),a=t(80318),l=t(67294),s=t(99816),c=t(35766),u=t(86419),d=t(1300),p=t(71416),f=t(23499),m=t(76736),g=t(14309),h=t(8736),v=t(94983),b=t(65382),x=t(11163),j=t(94184),y=t.n(j),w=t(29163),Z=t(85893),k=[{path:"/files",icon:"file outline",name:"Upload"},{path:"/docs",icon:"file alternate outline",name:"Docs"},{path:"/setting",icon:"setting",name:"Setting"}];var C=l.memo((0,w.ZP)((function(e){var n=(0,x.useRouter)(),t=(0,l.useCallback)((function(t,r){var o=r.index,i=k[o];i.path!==e.path&&n.push(i.path)}),[e.path]);return(0,Z.jsxs)(m.Z.Pushable,{as:c.Z,className:y()(e.className,"basic"),children:[(0,Z.jsx)(m.Z,{as:c.Z,animation:"push",direction:"left",visible:!0,className:"font1 basic",children:(0,Z.jsxs)(g.Z,{textAlign:"center",children:[(0,Z.jsx)(g.Z.Row,{columns:1,className:"logoPanel",children:(0,Z.jsx)(h.Z,{size:"small",src:"/images/crust_box2x.png"})}),(0,Z.jsx)(g.Z.Row,{columns:1,children:(0,Z.jsx)(v.Z,{fluid:!0,vertical:!0,borderless:!0,children:k.map((function(n,r){return(0,Z.jsx)(v.Z.Item,{position:"left",index:r,active:n.path===e.path,icon:(0,Z.jsx)(b.Z,{name:n.icon}),name:n.name,onClick:t,className:"font1"},"side_menu_".concat(r))}))})})]})}),(0,Z.jsx)(m.Z.Pusher,{children:e.children})]})}))(r||(r=(0,o.Z)(["\n  overflow: hidden;\n  height: 100vh;\n  background: white;\n\n  .ui.sidebar {\n    background: #F5F5F5;\n    box-shadow: unset !important;\n    .logoPanel {\n      padding: 2rem 0;\n    }\n    .menu {\n      box-shadow: unset !important;\n      border: unset !important;\n      border-radius: unset !important;\n      background: unset !important;\n\n      .item {\n        border-radius: 0;\n        text-align: left;\n        padding-left: 2rem !important;\n        font-weight: 500;\n        font-size: 1.3rem;\n        color: var(--secend-color);\n\n        &.active {\n          color: var(--main-color);\n        }\n\n        .icon {\n          float: left;\n          margin-right: 10px;\n        }\n      }\n    }\n  }\n\n  .pusher {\n    width: calc(100vw - 260px);\n    height: 100vh;\n    overflow: auto !important;\n    background: white;\n  }\n"])))),P=t(93162),S=t.n(P),O=t(92809),N=t(30266),A=t(809),_=t.n(A),E=t(9669),F=t.n(E);function z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function I(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?z(Object(t),!0).forEach((function(n){(0,O.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function H(){var e=(0,f.$)().t,n=(0,l.useMemo)((function(){return function(e){return[{location:e("Singapore"),text:e("DCF"),value:"https://crustipfs.xyz"},{location:e("United States"),text:e("Crust Network"),value:"https://crustwebsites.net"},{location:e("United States"),text:e("Crust Network"),value:"https://ipfs-gw.decloud.foundation"},{location:e("United States"),text:e("Crust Network"),value:"https://ipfs-gw.decloud.foundation",group:"Thunder Gateway"}]}(e).sort((function(){return Math.random()>.5?-1:1})).map((function(e){var n,t;return I(I({},e),{},{text:"".concat(null!==(n=e.text)&&void 0!==n?n:"","(").concat(null!==(t=e.location)&&void 0!==t?t:"",")")})}))}),[e]),t=(0,l.useState)(n[0]),r=t[0],o=t[1],i=(0,l.useCallback)((function(e,t){var r=t.value,i=n.find((function(e){return e.value===r}));i&&o(i)}),[n]);return(0,l.useMemo)((function(){return{endpoints:n,endpoint:r,setEndpoint:o,onChangeEndpoint:i}}),[n,r,i])}var D=t(345),T=t(73626),M=t(28258),R=t(37838),U=t(28803);function G(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=(0,l.useState)(e),t=n[0],r=n[1],o=(0,l.useCallback)((function(e){r(void 0!==e?e:function(e){return!e})}),[]);return[t,o]}var L,B=t(96486),J=t.n(B),W="_null",$=function(e){var n=e.expand,t=e.list,r=e.group,o=e.select,i=e.onClickItem,a=e.onClickGroup,l=e.renderGroupTitle,s=void 0===l?null:l,c=r===o.group;return(0,Z.jsxs)("div",{className:"group",children:[r!==W&&(s&&s({group:r,select:o,onClickGroup:a})||(0,Z.jsxs)("div",{className:y()("title",{active:c}),onClick:a,children:[r," ",(0,Z.jsx)(b.Z,{className:"dropIcon",name:"dropdown"})]})),n&&t.map((function(e,n){return(0,Z.jsx)("div",{className:y()("item",{active:c&&e.value===o.value}),onClick:function(n){return i(n,{group:r,value:e.value})},children:e.text},"group_item_".concat(n))}))]})};var q,Y=l.memo((0,w.ZP)((function(e){var n,t=e.className,r=e.label,o=e.help,i=e.options,s=e.defaultValue,c=e.defaultGroup,u=void 0===c?W:c,d=e.renderGroupTitle,p=(0,l.useState)({value:s,group:u}),f=p[0],m=p[1],g=(0,l.useMemo)((function(){return J().find(i,(function(e){return(e.group||W)===f.group&&e.value===f.value}))}),[i,f]),h=(0,l.useState)(u),v=h[0],x=h[1],j=G(),y=(0,a.Z)(j,2),w=y[0],k=y[1],C=function(e){var n=(0,l.useRef)(null);return(0,l.useEffect)((function(){var t,r=function(t){n.current&&n.current!==t.target&&!n.current.contains(t.target)&&e&&e(t)};return null===(t=document)||void 0===t||t.addEventListener("mouseup",r),function(){var e;null===(e=document)||void 0===e||e.removeEventListener("mouseup",r)}}),[n.current]),n}((function(){w&&k(!1)})),P=(0,l.useMemo)((function(){return J().groupBy(i,(function(e){return e.group||W}))}),[i]),S=J().keys(P);return(0,Z.jsxs)("div",{className:t,onClick:function(){return k()},ref:C,children:[r&&(0,Z.jsxs)("div",{className:"label",children:[r,o&&(0,Z.jsx)(U.Z,{position:"top center",trigger:(0,Z.jsx)(b.Z,{name:"question circle outline"}),content:o}),(0,Z.jsx)(b.Z,{name:"dropdown",className:"dropIcon"})]}),(0,Z.jsx)("div",{className:"text",children:null!==(n=null===g||void 0===g?void 0:g.text)&&void 0!==n?n:""}),w&&(0,Z.jsx)("div",{className:"options",children:S.map((function(n,t){return(0,Z.jsx)($,{group:n,renderGroupTitle:d,select:f,expand:v===n||n===W,list:P[n],onClickGroup:function(e){x(v===n?W:n),e.stopPropagation()},onClickItem:function(n,t){m(t),e.onChange(n,t)}},"group_".concat(t))}))})]})}))(L||(L=(0,o.Z)(["\n  position: relative;\n  width: 100%;\n  border-radius: 4px;\n  border: 1px solid var(--line-color);\n  padding: 0.8rem 1rem;\n  cursor: pointer;\n\n  .label {\n    font-size: 1.3rem;\n    white-space: nowrap;\n    color: var(--main-color);\n    margin-bottom: 0.6rem;\n\n    .icon {\n      margin-left: 0.5rem;\n      cursor: pointer;\n    }\n\n    .dropIcon {\n      float: right;\n      right: 0.6rem;\n    }\n  }\n\n  .text {\n    font-size: 1rem;\n    color: var(--secend-color);\n  }\n\n  .options {\n    width: 100%;\n    background: white;\n    position: absolute;\n    top: calc(100% + 1px);\n    left: 0;\n    z-index: 10;\n    border-radius: 4px;\n    border: 1px solid var(--line-color);\n    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);\n\n    .group {\n\n      .title {\n        cursor: pointer;\n        border-top: 1px solid var(--line-color);\n        padding: 0.8rem 1rem;\n        font-size: 1.2rem;\n        font-weight: 500;\n\n        &:hover, &.active {\n          background: var(--line-color);\n        }\n\n        .dropIcon {\n          float: right;\n          right: 0.6rem;\n        }\n      }\n\n      .item {\n        padding: 0.6rem 1.6rem;\n        cursor: pointer;\n\n        &:hover, &.active {\n          background: var(--line-color);\n        }\n      }\n    }\n  }\n"])))),V=t(48237);function X(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var K,Q=l.memo((0,w.ZP)((function(e){return(0,Z.jsx)(V.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?X(Object(t),!0).forEach((function(n){(0,O.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},e))}))(q||(q=(0,o.Z)(["\n  background: unset !important;\n  border: 1px solid var(--primary-color) !important;\n  color: var(--primary-color) !important;\n  font-weight: normal !important;\n\n  &:hover {\n    background: var(--primary-color) !important;\n    color: white !important;\n  }\n"]))));function ee(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ne(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ee(Object(t),!0).forEach((function(n){(0,O.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ee(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function te(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return re(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return re(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(l)throw i}}}}function re(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var oe=function(){};var ie,ae=l.memo((0,w.ZP)((function(e){var n=e.className,t=e.file,r=e.onClose,o=void 0===r?oe:r,i=e.onSuccess,c=void 0===i?oe:i,u=e.user,d=(0,f.$)().t,p=H(),m=p.endpoint,g=p.endpoints,h=p.onChangeEndpoint,v=function(){var e=(0,f.$)().t,n=(0,l.useMemo)((function(){return function(e){return[{text:e("Crust Pinner"),value:"https://pin.crustcode.com"}]}(e).sort((function(){return Math.random()>.5?-1:1})).map((function(e){var n;return I(I({},e),{},{text:"".concat(null!==(n=e.text)&&void 0!==n?n:"Pinner")})}))}),[e]),t=(0,l.useState)(n[0]),r=t[0],o=t[1],i=(0,l.useCallback)((function(e,t){var r=t.value,i=n.find((function(e){return e.value===r}));i&&o(i)}),[n]);return(0,l.useMemo)((function(){return{pinner:r,pins:n,setPinner:o,onChangePinner:i}}),[r,n,i])}(),b=v.onChangePinner,x=v.pinner,j=v.pins,y=(0,l.useState)(""),w=y[0],k=(y[1],(0,l.useState)(!1)),C=k[0],P=k[1],S=(0,l.useMemo)((function(){var e=104857600;if(t.file)return t.file.size>e;if(t.files){var n,r=0,o=te(t.files);try{for(o.s();!(n=o.n()).done;){r+=n.value.size}}catch(i){o.e(i)}finally{o.f()}return r>e}return!1}),[t]),O=(0,l.useState)(""),A=O[0],E=O[1],z=S?d("Do not upload files larger than 100MB!"):A,U=(0,l.useState)({progress:0,up:!1}),L=U[0],B=U[1],J=(0,l.useState)(null),W=J[0],$=J[1],q=(0,l.useCallback)((function(){W&&W.cancel(),o()}),[W,o]),V=(0,l.useCallback)((0,N.Z)(_().mark((function e(){var n,r,o,i,a,l,p,f,g,h,v,b,j,y,w,Z,k,C,S;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E(""),u.account&&u.sign){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,P(!0),n=(0,s.WJ)(u),r="near"===u.wallet?u.pubKey||"":u.account,e.next=9,u.sign(r,u.account);case 9:if(o=e.sent,i="elrond"===u.wallet?o:"".concat(n,"-").concat(r,":").concat(o),a=window.btoa(i),l="Basic ".concat(a),p="Bearer ".concat(a),f=F().CancelToken.source(),$(f),B({progress:0,up:!0}),g=new FormData,t.file)g.append("file",t.file,t.file.name);else if(t.files){h=te(t.files);try{for(h.s();!(v=h.n()).done;)b=v.value,g.append("file",b,b.webkitRelativePath)}catch(O){h.e(O)}finally{h.f()}}return j=m.value,e.next=22,F().request({cancelToken:f.token,data:g,headers:{Authorization:l},maxContentLength:104857600,method:"POST",onUploadProgress:function(e){var n=e.loaded/e.total;B({progress:Math.round(99*n),up:!0})},params:{pin:!0},url:"".concat(j,"/api/v0/add")});case 22:return"string"===typeof(y=e.sent).data?(Z=y.data.replaceAll("}\n{","},{"),k=JSON.parse("[".concat(Z,"]")),C=k.length-1,w=k[C],delete k[C],w.items=k):w=y.data,console.info("upResult:",y),$(null),B({progress:100,up:!1}),S=x.value,e.next=30,F().request({data:{cid:w.Hash,name:w.Name},headers:{Authorization:p},method:"POST",url:"".concat(S,"/psa/pins")});case 30:c(ne(ne({},w),{},{PinEndpoint:S,UpEndpoint:j})),e.next=39;break;case 33:e.prev=33,e.t0=e.catch(3),B({progress:0,up:!1}),P(!1),console.error(e.t0),E(d("Network Error,Please try to switch a Gateway."));case 39:case"end":return e.stop()}}),e,null,[[3,33]])}))),[u,t,w,x,m,c,d]),X=G(),K=(0,a.Z)(X,2),ee=K[0],re=K[1];return(0,Z.jsxs)(D.Z,{closeIcon:!0,onClose:q,open:!0,size:"large",className:n,children:[(0,Z.jsx)(D.Z.Header,{children:d(t.dir?"Upload Folder":"Upload File")}),(0,Z.jsxs)(D.Z.Content,{children:[(0,Z.jsxs)(T.Z.Group,{children:[(0,Z.jsx)(T.Z,{fluid:!0,children:(0,Z.jsxs)(T.Z.Content,{children:[(0,Z.jsx)(T.Z.Header,{content:t.dir?"Folder":"File"}),(0,Z.jsx)(T.Z.Description,{content:t.dir?"".concat(t.dir," (").concat(t.files.length," files)"):"".concat(t.file.name," (").concat(t.file.size," bytes)")})]})}),(0,Z.jsx)(T.Z,{fluid:!0,children:(0,Z.jsx)(Y,{fluid:!0,selection:!0,help:d("File streaming and wallet authentication will be processed by the chosen gateway."),disabled:C,label:d("Select a Web3 IPFS Gateway"),onChange:h,options:g,defaultValue:m.value})}),(0,Z.jsx)(T.Z,{fluid:!0,children:(0,Z.jsx)(Y,{fluid:!0,selection:!0,help:d("Your file will be pinned to IPFS for long-term storage."),disabled:0===j.length,label:d("Select a Web3 IPFS Pinner"),onChange:b,options:j,defaultValue:x.value})}),(0,Z.jsx)(T.Z,{fluid:!0,className:"encryption",children:(0,Z.jsxs)(T.Z.Content,{children:[(0,Z.jsx)(T.Z.Header,{content:"File Encryption"}),(0,Z.jsx)(T.Z.Description,{content:ee?"Yes":"No"}),(0,Z.jsx)(M.Z,{toggle:!0,defaultChecked:ee,onChange:function(){return re()}})]})})]}),z&&(0,Z.jsx)("div",{style:{color:"orangered",padding:"1rem",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:z})]}),(0,Z.jsx)(D.Z.Actions,{children:(0,Z.jsxs)("div",{className:"uploading",children:[L.up&&(0,Z.jsx)(R.Z,{value:L.progress,total:100,active:!0,color:"orange"}),L.up&&(0,Z.jsx)(Q,{color:"orange",children:d("Cancel")}),!L.up&&(0,Z.jsx)(Q,{fluid:!0,onClick:V,color:"orange",children:d("Sing and Upload")})]})})]})}))(K||(K=(0,o.Z)(['\n\n  .header:nth-child(2) {\n    height: 3.36rem;\n    font-size: 1rem !important;\n    padding: 0 1rem !important;\n    font-weight: unset !important;\n    line-height: 3.36rem !important;\n  }\n\n\n  .close.icon {\n    top: 0.5rem;\n    right: 0.6rem;\n    color: #666666;\n  }\n\n  .content {\n    padding: 1rem !important;\n  }\n\n  .ui.cards > .card {\n    margin: 0.5rem !important;\n    .content>.header {\n      font-size: 1.14rem;\n      font-weight: unset !important;\n    }\n    .content>.description {\n      font-size: 1rem;\n    }\n  }\n\n  .ui.cards > .card:first-child {\n    margin-top: 1rem !important;\n  }\n\n  .actions {\n    height: 4.8rem;\n    padding: 0.5rem 1rem 0 1rem !important;\n    border-top: unset !important;\n    background: unset !important;\n\n    .button {\n      margin-left: unset !important;\n    }\n  }\n\n  .uploading {\n    height: 4rem;\n    display: flex;\n    align-items: center;\n\n    .progress {\n      margin: 0 1rem 0 0 !important;\n      vertical-align: baseline;\n      background: unset !important;\n      border: 1px solid orange;\n      flex: 1;\n\n      .bar {\n        min-width: unset !important;\n        height: 2.5rem;\n      }\n    }\n  }\n  \n  .card.encryption {\n    position: relative;\n    .toggle {\n      position: absolute;\n      top: calc(50% - 0.75rem);\n      right: 1rem;\n      \n      input[type="radio"]:checked + label:before{\n        background-color: #2ED158 !important;\n      }\n    }\n  }\n'])))),le=t(12752),se=t(88188),ce=t(4838);function ue(e){switch(e){case"crust":return"/images/wallet_crust.png";case"polkadot-js":return"/images/wallet_polkadot.png";case"metamask":return"/images/wallet_metamask.png";case"near":return"/images/wallet_near.png";case"solana":return"/images/wallet_solana.png";case"elrond":return"/images/wallet_elrond.png";case"flow":return"/images/wallet_flow.png";default:return""}}var de=l.memo((0,w.ZP)((function(e){var n,t=(0,s.WY)(),r=(0,l.useCallback)(t.logout,[t]);return(0,Z.jsx)(c.Z,{basic:!0,textAlign:"right",className:e.className,style:{borderBottom:"2px solid #eeeeee"},children:(0,Z.jsx)(se.Z.Group,{children:(0,Z.jsxs)(se.Z,{style:{justifyContent:"flex-end"},children:[(0,Z.jsx)(se.Z.Image,{src:ue(t.wallet),size:"tiny"}),(0,Z.jsx)(se.Z.Content,{verticalAlign:"middle",style:{flex:"unset",paddingLeft:"0.5rem"},children:(0,Z.jsx)(ce.Z,{text:(n=t.account,n.length<=8?n:"".concat(n.substr(0,4),"...").concat(n.substr(n.length-4,4))),children:(0,Z.jsx)(ce.Z.Menu,{children:(0,Z.jsx)(ce.Z.Item,{text:"Logout",onClick:r})})})})]})})})}))(ie||(ie=(0,o.Z)(['\n  border-bottom: 2px solid #eeeeee;\n  .ui.dropdown  {\n    .text {\n      font-family: "ArialRoundedMTBold";\n      font-size: 1.3rem;\n    }\n  }\n']))));var pe=t(56755),fe=t.n(pe),me=t(20640),ge=t.n(me);var he,ve=t(66103),be=t(98278);function xe(e){return e}function je(e){e.current.isActive=!1,e.current.subscriber&&(e.current.subscriber.then((function(e){return e()})).catch(console.error),e.current.subscriber=null)}function ye(e,n,t){var r=function(){var e=(0,l.useRef)(!1);return(0,l.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e}(),o=(0,l.useRef)({isActive:!1,serialized:null,subscriber:null}),s=(0,l.useState)((t||{}).defaultValue),c=s[0],u=s[1];return(0,l.useEffect)((function(){return function(){return je(o)}}),[]),(0,l.useEffect)((function(){if(r.current&&e){var l=function(e,n){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).paramMap,r=void 0===t?xe:t;return[JSON.stringify({f:null===e||void 0===e?void 0:e.name,p:n}),0!==n.length&&n.some((function(e){return(0,ve.F)(e)||(0,be.o)(e)}))?null:r(n)]}(e,n||[],t),s=(0,a.Z)(l,2),c=s[0],d=s[1];d&&c!==o.current.serialized&&(o.current.serialized=c,function(e,n,t,r,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l=a.transform,s=void 0===l?xe:l,c=a.withParams,u=a.withParamsTransform,d=r.filter((function(e){return!(0,be.o)(e)}));je(n),setTimeout((function(){var a;e.current&&(!t||t.meta&&null!==(a=t.meta.type)&&void 0!==a&&a.isDoubleMap&&2!==d.length?n.current.subscriber=null:(n.current.isActive=!0,n.current.subscriber=t.apply(void 0,(0,i.Z)(r).concat([function(t){e.current&&n.current.isActive&&e.current&&n.current.isActive&&o(c?[r,s(t)]:s(u?[r,t]:t))}]))))}),0)}(r,o,e,d,u,t))}}),[e,t,r,n]),c}function we(e,n){var t=n.find((function(n){return n.value===e.UpEndpoint})),r=t&&t.value||n[0].value;return"".concat(r,"/ipfs/").concat(e.Hash,"?filename=").concat(e.Name)}var Ze=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return e.length>2*n?"".concat(e.substr(0,n),"...").concat(e.substr(e.length-n)):e};var ke,Ce=l.memo((0,w.ZP)((function(e){var n,t,r=e.file,o=e.className,i=function(){var e=(0,l.useContext)(le.I).alert;return(0,l.useCallback)((function(n){ge()(n),e.alert({msg:"Copied",type:"success"})}),[e])}(),a=(0,l.useContext)(le.I).api,s=H().endpoints,c=(0,l.useCallback)((function(){return i(we(r,s))}),[r,s]),u=ye(a&&(null===(n=a.query)||void 0===n?void 0:n.market)&&(null===(t=a.query)||void 0===t?void 0:t.market.files),[r.Hash]),p=ye(a&&a.derive.chain.bestNumber);p=p&&JSON.parse(JSON.stringify(p));var f={status:"Loading"};if(u){var m=JSON.parse(JSON.stringify(u));if(m){var g=m.expired_at,h=m.reported_replica_count;f.expireTime=m.expired_at,f.amount=m.amount,f.startTime=m.expired_at?m.expired_at-216e3:0,f.fileSize=m.file_size,f.confirmedReplicas=m.reported_replica_count,f.prepaid=m.prepaid,g&&g<p&&(f.status="Expired"),!g&&g>p&&h<1&&(f.status="Waiting"),g&&g>p&&h>0&&(f.status="Success")}}return(0,Z.jsxs)(d.Z.Row,{className:o,children:[(0,Z.jsx)(d.Z.Cell,{children:Ze(r.Name)}),(0,Z.jsxs)(d.Z.Cell,{textAlign:"center",children:[Ze(r.Hash),(0,Z.jsx)("span",{onClick:function(){return i(r.Hash)},style:{cursor:"pointer",paddingLeft:10},children:(0,Z.jsx)(b.Z,{name:"clone outline"})})]}),(0,Z.jsx)(d.Z.Cell,{textAlign:"center",children:fe()(Number(r.Size),{round:2})}),(0,Z.jsxs)(d.Z.Cell,{textAlign:"center",children:["Loading"===f.status&&(0,Z.jsx)(b.Z,{loading:!0,name:"spinner"}),"Waiting"===f.status&&f.status,"Expired"===f.status&&f.status,"Success"===f.status&&"".concat(f.status," (").concat(f.confirmedReplicas," replicas)")]}),(0,Z.jsxs)(d.Z.Cell,{textAlign:"center",children:[(0,Z.jsx)("span",{style:{cursor:"pointer"},children:(0,Z.jsx)(b.Z,{name:"external"})}),(0,Z.jsx)("span",{style:{cursor:"pointer"},onClick:c,children:(0,Z.jsx)(b.Z,{name:"clone outline"})})]})]})}))(he||(he=(0,o.Z)(["\n  color: var(--secend-color) !important;\n"]))));function Pe(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return Se(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Se(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((function(e){throw e})),f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((function(e){l=!0,i=e})),f:function(){try{a||null==t.return||t.return()}finally{if(l)throw i}}}}function Se(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var Oe=l.memo((0,w.ZP)((function(e){var n=(0,s.WY)(),t=(0,f.$)().t,r=(0,l.useContext)(le.I).alert,o=(0,l.useState)(!1),m=o[0],g=o[1],h=(0,s.Yg)(),v=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,t=(0,l.useState)(1),r=t[0],o=t[1];return(0,l.useMemo)((function(){var t=J().chunk(e,n);return{totalPage:t.length,pageList:t[r-1]||[],setPage:o,page:r}}),[e,r])}(h.files,5),b=(0,l.useState)(void 0),x=b[0],j=b[1],y=(0,l.useRef)(null),w=(0,l.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y.current&&(y.current.webkitdirectory=e,y.current.multiple=e,y.current.click())}),[y]),k=(0,l.useCallback)((function(){return w(!1)}),[w]),P=(0,l.useCallback)((function(){return w(!0)}),[w]),O=(0,l.useCallback)((function(e){var n=e.target.files;if(n)if(n.length>2e3)r.alert({title:t("Upload"),msg:t("Please do not upload more than 2000 files"),type:"error"});else if(0!==n.length){if(e.target.webkitdirectory){if(n.length>=1){for(var o=[],i=0;i<n.length;i++)o.push(n[i]);console.info(o);var l=o[0].webkitRelativePath.split("/"),s=(0,a.Z)(l,1)[0];j({files:o,dir:s}),g(!0)}}else j({file:n[0]}),g(!0);e.target.value=""}else r.alert({title:t("Upload"),msg:t("Please select non-empty folder"),type:"error"})}),[j,g,r,t]),N=(0,l.useRef)(null),A=(0,l.useCallback)((function(){N.current&&N.current.click()}),[N]),_=(0,l.useCallback)((function(e){try{var n=new FileReader,o=e.target.files;if(!o)return;if(n.readAsText(o[0],"UTF-8"),!/(.json)$/i.test(e.target.value))return r.alert({msg:t("File error"),type:"error"});n.onload=function(e){var n,o=JSON.parse(null===(n=e.target)||void 0===n?void 0:n.result);if(!Array.isArray(o))return r.alert({msg:t("File content error"),type:"error"});var a,l=[],s={},c=Pe(o);try{for(c.s();!(a=c.n()).done;){var u=a.value;u.Hash&&u.Name&&u.UpEndpoint&&u.PinEndpoint&&(l.push(u),s[u.Hash]=!0)}}catch(p){c.e(p)}finally{c.f()}var d=h.files.filter((function(e){return!s[e.Hash]}));h.setFiles([].concat(l,(0,i.Z)(d))),r.alert({msg:t("Import Success"),type:"success"})}}catch(e){r.alert({msg:t("File content error"),type:"error"})}}),[h,r,t]),E=(0,l.useCallback)((function(){g(!1)}),[]),F=(0,l.useCallback)((function(e){g(!1);var n=h.files.filter((function(n){return n.Hash!==e.Hash}));h.setFiles([e].concat((0,i.Z)(n)))}),[h]),z=(0,l.useCallback)((function(){var e=new Blob([JSON.stringify(h.files)],{type:"application/json; charset=utf-8"});S().saveAs(e,"files.json")}),[h]);return(0,Z.jsx)(C,{path:"/files",children:(0,Z.jsxs)(c.Z,{basic:!0,className:e.className,children:[(0,Z.jsx)(de,{}),(0,Z.jsxs)(c.Z,{basic:!0,textAlign:"center",className:"font1 uploadPanel",children:[(0,Z.jsx)("input",{onChange:O,ref:y,style:{display:"none"},type:"file"}),(0,Z.jsx)("input",{onChange:_,ref:N,style:{display:"none"},type:"file"}),(0,Z.jsx)("span",{children:"Upload"}),(0,Z.jsx)(u.Z,{animation:"jiggle",duration:800,visible:!0,children:(0,Z.jsx)("span",{className:"btn file",onClick:k,children:"File"})}),(0,Z.jsx)("span",{children:"or"}),(0,Z.jsx)(u.Z,{animation:"jiggle",duration:800,visible:!0,children:(0,Z.jsx)("span",{className:"btn folder",onClick:P,children:"Folder"})}),(0,Z.jsx)("span",{children:"to IPFS."}),m&&(0,Z.jsx)(ae,{file:x,user:n,onClose:E,onSuccess:F})]}),(0,Z.jsx)("span",{className:"font1 filesTitle",children:"Upload History"}),(0,Z.jsxs)(d.Z,{basic:"very",singleLine:!0,children:[(0,Z.jsx)(d.Z.Header,{children:(0,Z.jsxs)(d.Z.Row,{children:[(0,Z.jsx)(d.Z.HeaderCell,{children:"File Name"}),(0,Z.jsx)(d.Z.HeaderCell,{textAlign:"center",children:"File CID"}),(0,Z.jsx)(d.Z.HeaderCell,{textAlign:"center",children:"File Size"}),(0,Z.jsx)(d.Z.HeaderCell,{textAlign:"center",children:"Status"}),(0,Z.jsx)(d.Z.HeaderCell,{textAlign:"center",children:"Action"})]})}),(0,Z.jsx)(d.Z.Body,{children:v.pageList.map((function(e,n){return(0,Z.jsx)(Ce,{file:e},"files_".concat(n))}))}),(0,Z.jsx)(d.Z.Footer,{children:(0,Z.jsxs)(d.Z.Row,{children:[(0,Z.jsxs)(d.Z.HeaderCell,{colSpan:"2",children:[(0,Z.jsx)(Q,{onClick:A,children:"Import"}),(0,Z.jsx)(Q,{onClick:z,children:"Export"})]}),v.totalPage>1&&(0,Z.jsx)(d.Z.HeaderCell,{colSpan:"3",textAlign:"right",children:(0,Z.jsx)(p.Z,{totalPages:v.totalPage,activePage:v.page,onPageChange:function(e,n){var t=n.activePage;return v.setPage(t)}})})]})})]})]})})}))(ke||(ke=(0,o.Z)(["\n  padding: unset !important;\n\n  .table {\n    padding: 1rem 2rem;\n    thead{\n      font-size: 1.3rem;\n    }\n  }\n  \n  \n  .uploadPanel {\n    font-size: 5rem !important;\n    line-height: 17.14rem;\n    white-space: nowrap;\n    padding: 2rem 1rem;\n    .btn {\n      display: inline-block;\n      width: 18.57rem;\n      height: 17.14rem;\n      text-align: center;\n      margin: 0 10px;\n      border-radius: 50px;\n      cursor: pointer;\n      //transition: all ease-in-out 2s;\n    }\n\n    .file {\n      background: rgba(255, 141, 0, 0.1);\n\n      &:hover {\n        background: rgba(255, 141, 0, 0.2);\n      }\n    }\n\n    .folder {\n      background: rgba(86, 203, 143, 0.1);\n\n      &:hover {\n        background: rgba(86, 203, 143, 0.2);\n      }\n    }\n  }\n\n  .filesTitle {\n    font-size: 2.8rem;\n    margin-left: 2rem;\n    line-height: 60px;\n  }\n"]))))},62356:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/files",function(){return t(21160)}])}},function(e){e.O(0,[934,416,774,888,179],(function(){return n=62356,e(e.s=n);var n}));var n=e.O();_N_E=n}]);