"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[17],{54040:function(e,t,n){n.d(t,{P:function(){return c},n:function(){return s}});var r=n(30266),a=n(809),o=n.n(a),u=function(){var e=(0,r.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveKey"]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=(0,r.Z)(o().mark((function e(t,n,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.deriveKey(r,t,{name:"AES-GCM",length:256},!1,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),c=function(){var e=(0,r.Z)(o().mark((function e(t,n){var r,a,c,s,l,f,p,d,y;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new Uint8Array(t),a=(new TextEncoder).encode(n),c=window.crypto.getRandomValues(new Uint8Array(16)),s=window.crypto.getRandomValues(new Uint8Array(12)),e.next=7,u(a);case 7:return l=e.sent,e.next=10,i(l,["encrypt"],{name:"PBKDF2",salt:c,iterations:25e4,hash:"SHA-256"});case 10:return f=e.sent,e.next=13,window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},f,r);case 13:return p=e.sent,d=new Uint8Array(p),(y=new Uint8Array(d.byteLength+c.byteLength+s.byteLength)).set(c,0),y.set(s,c.byteLength),y.set(d,c.byteLength+s.byteLength),e.abrupt("return",y);case 22:throw e.prev=22,e.t0=e.catch(0),console.error("Error encrypting file"),console.error(e.t0),e.t0;case 27:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(t,n){return e.apply(this,arguments)}}(),s=function(){var e=(0,r.Z)(o().mark((function e(t,n){var r,a,c,s,l,f,p,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new Uint8Array(t),a=(new TextEncoder).encode(n),c=r.slice(0,16),s=r.slice(16,28),l=r.slice(28),e.next=8,u(a);case 8:return f=e.sent,e.next=11,i(f,["decrypt"],{name:"PBKDF2",salt:c,iterations:25e4,hash:"SHA-256"});case 11:return p=e.sent,e.next=14,window.crypto.subtle.decrypt({name:"AES-GCM",iv:s},p,l);case 14:return d=e.sent,e.abrupt("return",d);case 18:return e.prev=18,e.t0=e.catch(0),console.error("Error decrypting file"),console.error(e.t0),e.abrupt("return");case 23:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}()},56262:function(e,t,n){n.d(t,{T:function(){return f},q:function(){return p}});var r=n(92809),a=n(67294),o=n(75282),u=n(23499),i=n(58971),c=n.n(i);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"upload:last-gateway",t=(0,u.$)(),n=t.t,r=(0,a.useMemo)((function(){return(0,o.Dl)(n).map((function(e){var t,n;return l(l({},e),{},{text:"".concat(null!==(t=e.text)&&void 0!==t?t:""," (").concat(null!==(n=e.location)&&void 0!==n?n:"",")")})}))}),[n]),i=(0,a.useMemo)((function(){var t=c().get(e);if(t){var n=r.findIndex((function(e){return e.value===t.value}));if(n>=0)return n}return 0}),[e,r]),s=(0,a.useState)(r[i]),f=s[0],p=s[1],d=(0,a.useCallback)((function(t){p((function(n){var r="function"===typeof t?t(n):t;return c().set(e,{value:r.value}),r}))}),[]),y=(0,a.useCallback)((function(e,t){var n=t.value,a=r.find((function(e){return e.value===n}));a&&d(a)}),[r,d]);return(0,a.useMemo)((function(){return{endpoints:r,endpoint:f,setEndpoint:d,onChangeEndpoint:y}}),[r,f,d,y])}function p(){var e=(0,u.$)().t,t=(0,a.useMemo)((function(){return(0,o.qi)(e).sort((function(){return Math.random()>.5?-1:1})).map((function(e){var t;return l(l({},e),{},{text:"".concat(null!==(t=e.text)&&void 0!==t?t:"Pinner")})}))}),[e]),n=(0,a.useState)(t[0]),r=n[0],i=n[1],c=(0,a.useCallback)((function(e,n){var r=n.value,a=t.find((function(e){return e.value===r}));a&&i(a)}),[t]);return(0,a.useMemo)((function(){return{pinner:r,pins:t,setPinner:i,onChangePinner:c}}),[r,t,c])}},10416:function(e,t,n){n.d(t,{V:function(){return h}});var r=n(92809),a=n(30266),o=n(809),u=n.n(o),i=n(9669),c=n.n(i),s=n(67294),l=n(54040),f=n(17082),p=n(96705);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){i=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(i)throw o}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=1048576;function h(e,t){var n=(0,s.useState)(),r=n[0],o=n[1],i=(0,s.useState)({progress:0,up:!1}),d=i[0],b=i[1],h=(0,s.useState)(null),m=h[0],g=h[1],O=(0,s.useState)(!1),x=O[0],P=O[1],k=t.isEncrypt,j=void 0!==k&&k,S=t.secret,E=t.file,A=t.isPremium,D=void 0!==A&&A,M=t.endpoint,C=t.pinner,T=(0,s.useMemo)((function(){return D?1024:40}),[D]),U=(0,s.useMemo)((function(){if(!E)return!1;if(E.file)return E.file.size>T*w;if(E.files){var e,t=0,n=v(E.files);try{for(n.s();!(e=n.n()).done;){t+=e.value.size}}catch(r){n.e(r)}finally{n.f()}return t>T*w}return!1}),[E,T]);return{upload:function(){var t=(0,a.Z)(u().mark((function t(n){var r,a,i,s,d,w,h,m,O,x,k,A,D,U,B,Z,K,L,R,z,F,N,_,q,G,I,H,V,$,J,W,Q;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,P(!0),r=(0,p.WJ)(e),a="near"===e.wallet?e.pubKey||"":e.account,t.next=6,e.sign(a,e.account);case 6:if(i=t.sent,s="elrond"===e.wallet?i:"".concat(r,"-").concat(a,":").concat(i),d=window.btoa(s),w="Basic ".concat(d),h="Bearer ".concat(d),m=c().CancelToken.source(),g(m),b({progress:0,up:!0}),O=new FormData,x=n||E,!j){t.next=57;break}if(!x.file){t.next=31;break}return k=(new Date).getTime(),t.next=21,(0,f.vZ)(x.file);case 21:return A=t.sent,console.info("readFile::",((new Date).getTime()-k)/1e3),t.next=25,(0,l.P)(A,S);case 25:D=t.sent,console.info("encrypted::",((new Date).getTime()-k)/1e3),U=new Blob([D],{type:x.file.type}),O.append("file",U,x.file.name),t.next=55;break;case 31:if(!x.files){t.next=55;break}B=v(x.files),t.prev=33,B.s();case 35:if((Z=B.n()).done){t.next=47;break}return K=Z.value,t.next=39,(0,f.vZ)(K);case 39:return L=t.sent,t.next=42,(0,l.P)(L,S);case 42:R=t.sent,z=new Blob([R],{type:K.type}),O.append("file",z,K.webkitRelativePath);case 45:t.next=35;break;case 47:t.next=52;break;case 49:t.prev=49,t.t0=t.catch(33),B.e(t.t0);case 52:return t.prev=52,B.f(),t.finish(52);case 55:t.next=58;break;case 57:if(x.file)O.append("file",x.file,x.file.name);else if(x.files){F=v(x.files);try{for(F.s();!(N=F.n()).done;)_=N.value,O.append("file",_,_._webkitRelativePath||_.webkitRelativePath)}catch(u){F.e(u)}finally{F.f()}}case 58:return q=M.value,t.next=61,c().request({cancelToken:m.token,data:O,headers:{Authorization:w},maxContentLength:T,method:"POST",onUploadProgress:function(e){var t=e.loaded/e.total;b({progress:Math.round(99*t),up:!0})},params:{pin:!0},url:"".concat(q,"/api/v0/add")});case 61:return"string"===typeof(G=t.sent).data?(H=G.data.replaceAll("}\n{","},{"),V=JSON.parse("[".concat(H,"]")),$=V.length-1,I=V[$],delete V[$],I.items=V):I=G.data,console.info("upResult:",G),g(null),b({progress:99,up:!0}),J=C.value,t.next=69,c().request({data:{cid:I.Hash,name:I.Name},headers:{Authorization:h},method:"POST",url:"".concat(J,"/psa/pins")});case 69:return b({progress:100,up:!1}),W=y(y({},I),{},{PinEndpoint:J,PinTime:(new Date).getTime(),UpEndpoint:q,Encrypted:j}),Q={msg:a,signature:i},t.abrupt("return",[W,Q]);case 75:throw t.prev=75,t.t1=t.catch(0),b({progress:0,up:!1}),P(!1),console.error(t.t1),o("Network Error,Please try to switch a Gateway."),t.t1;case 82:case"end":return t.stop()}}),t,null,[[0,75],[33,49,52,55]])})));return function(e){return t.apply(this,arguments)}}(),error:U?"Do not upload files larger than ".concat(T,"MB!"):r,isBusy:x,upState:d,cancelUp:m,fileSizeError:U}}}}]);